<% content_for(:page_title, "UC BEARS") %>

<h1>UC Berkeley Electronic and Accessible Reserves System</h1>

<%# TODO: style navigation properly %>
<nav><%= link_to 'Add Lending Item', lending_new_path %></nav>

<%# TODO: test sorting %>
<table class="table table-bordered mt-5">
  <thead class="thead-light">
  <tr>
    <th scope="col"><%= sortable(:title, 'Title') %></th>
    <th scope="col"><%= sortable(:author, 'Author') %></th>
    <th scope="col"><%= sortable(:directory, 'Filename') %></th>
    <th scope="col"><%= sortable(:copies, 'Copies') %></th>
    <th scope="col"><%= sortable(:copies_available, 'Available') %></th>
    <th scope="col">Due</th>
    <th colspan="3"></th>
  </tr>
  </thead>

  <tbody>
  <% @lending_items.each do |item| %>
    <% directory = item.directory %>
    <tr>
      <td><%= item.title %></td>
      <td><%= item.author %></td>
      <td><%= directory %></td>
      <td><%= item.copies %></td>
      <td><%= item.copies_available %></td>
      <td>
        <% unless (due_dates = item.due_dates.to_a).empty? %>
          <ul>
            <% due_dates.each do |d| %>
              <li><%= d %></li>
            <% end %>
          </ul>
        <% end %>
      </td>
      <td><%= link_to 'Show', lending_show_path(directory: directory) %></td>
      <td><%= link_to 'Edit', lending_edit_path(directory: directory) %></td>
      <td><%= link_to 'Destroy', lending_destroy_path(directory: directory), method: :delete, data: { confirm: 'Are you sure?' } %></td>
    </tr>
  <% end %>
  </tbody>
</table>
